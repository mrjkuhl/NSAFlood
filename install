#!/bin/bash

CURRENTDIR=$(pwd)
DESTINATIONBIN="/usr/local/bin/"
DESTINATIONMAN="/usr/share/man/man1/"
FILEBIN="nsaflood"
FILEMAN="nsaflood.1.gz"
FILEMANSRC="nsaflood.1"

if [ $USER != "root" ]; then

	echo -ne " Only root can install programs.\n"\
	"Exiting...\n"

	exit 1
fi

echo -n "Moving $FILEBIN to $DESTINATIONBIN..."

cp $CURRENTDIR/$FILEBIN $DESTINATIONBIN

if [ $? -ne 0 ]; then

	echo -ne " ERROR: Could not copy $FILEBIN to $DESTINATIONBIN\n"\
	"This may be due to insufficient file permissions, or the partition being full.\n"\
	"Exiting...\n"

	exit 2
fi

echo -ne " success!\n"\
"Updating file ownership and permissions on $FILEBIN..."

chown root:root $DESTINATIONBIN/$FILEBIN
chmod 755 $DESTINATIONBIN/$FILEBIN

echo -ne " success!\n"\
"Compressing $FILEMANSRC and moving to $DESTINATIONMAN..."

gzip --stdout $CURRENTDIR/$FILEMANSRC > $DESTINATIONMAN/$FILEMAN

if [ $? -ne 0 ]; then

	echo -ne " ERROR: Could not copy nsaflood.1.gz to $DESTINATIONMAN\n"\
	"This may be due to insuffiencet file permissions, or the partition being full.\n"\
	"Exiting...\n"

	exit 2
fi

echo -ne " success!\n"\
"Updating file ownership and permissions of $FILEMAN..."

chown root:root $DESTINATIONMAN/$FILEMAN
chmod 755 $DESTINATIONMAN/$FILEMAN

echo -ne " success!\n\n"\
"Installation of NSAFlood finished successfully.\n"

exit 0
